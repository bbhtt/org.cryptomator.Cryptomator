{
  "app-id": "org.cryptomator.Cryptomator",
  "command": "cryptomator",
  "runtime": "org.freedesktop.Platform",
  "runtime-version": "21.08",
  "sdk": "org.freedesktop.Sdk",
  "sdk-extensions": [
    "org.freedesktop.Sdk.Extension.openjdk"
  ],
  "separate-locales": false,
  "finish-args": [
    "--device=dri",
    "--env=PATH=/app/bin/:/app/jre/bin/:/usr/bin/",
    "--filesystem=host",
    "--share=ipc",
    "--share=network",
    "--socket=session-bus",
    "--socket=x11",
    "--talk-name=org.freedesktop.Flatpak",
    "--talk-name=org.freedesktop.Notifications",
    "--talk-name=org.freedesktop.secrets",
    "--talk-name=org.gtk.vfs.*",
    "--talk-name=org.gtk.vfs"
  ],
  "cleanup": [
    "/include",
    "/lib/pkgconfig"
  ],
  "modules": [
    {
      "name": "libfuse",
      "config-opts": [
        "MOUNT_FUSE_PATH=/app/bin"
      ],
      "post-install": [
        "install fusermount-wrapper.sh /app/bin/fusermount"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://github.com/libfuse/libfuse/releases/download/fuse-2.9.9/fuse-2.9.9.tar.gz",
          "sha256": "d0e69d5d608cc22ff4843791ad097f554dd32540ddc9bed7638cc6fea7c1b4b5"
        },
        {
          "type": "file",
          "path": "build-aux/fusermount-wrapper.sh"
        }
      ]
    },
    {
      "name": "openjdk",
      "buildsystem": "simple",
      "build-commands": ["/usr/lib/sdk/openjdk/install.sh"]
    },
    {
      "name": "cryptomator",
      "buildsystem": "simple",
      "build-commands": [
        "unzip buildkit-linux.zip -d /app/Cryptomator/",
        "install -D -m0755 cryptomator.sh /app/bin/cryptomator",
        "install -D -m0644 -t /app/share/applications/ org.cryptomator.Cryptomator.desktop",
        "install -D -m0644 -t /app/share/icons/hicolor/scalable/apps/ org.cryptomator.Cryptomator.svg",
        "install -D -m0644 -t /app/share/metainfo/ org.cryptomator.Cryptomator.appdata.xml"

      ],
      "sources": [
        {
          "type": "file",
          "path": "cryptomator.sh"
        },
        {
          "type": "file",
          "path": "org.cryptomator.Cryptomator.appdata.xml"
        },
        {
          "type": "file",
          "path": "org.cryptomator.Cryptomator.desktop"
        },
        {
          "type": "file",
          "path": "org.cryptomator.Cryptomator.svg"
        },
        {
          "type": "file",
          "sha256": "200ae9e597012226eef3143a67b73b39270033e78b4873aa6d490242576fca7d",
          "url": "https://github.com/cryptomator/cryptomator/releases/download/1.5.1/buildkit-linux.zip"
        }
      ]
    }
  ]
}